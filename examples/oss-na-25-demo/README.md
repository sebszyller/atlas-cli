# Open Source Summit North America (OSS NA) '25 Provenance Demo

## Introduction

This example demonstrates how to generate and verify provenance data for a
two-stage machine learning lifecycle using the Atlas CLI tool. Although the demo
contains scripts for training and evaluation pipelines, the demo does not run
them but still tracks these software components as part of the lifecycle from
dataset download to evaluation, showing how to establish an end-to-end audit
trail of all artifacts and their relationships.

To show the added integrity properties gained from running the Atlas CLI inside
of a confidential computing environment such as Intel TDX, the demo will
collect a hardware-based platform attestation and include it in each artifact
manifest generated by the CLI. When run on platforms that do not support Intel
TDX, the demo will still generate a mock hardware attestation.

This example creates C2PA-compliant manifests for:
- Datasets (raw MNIST training and test datasets downloaded from HuggingFace)
- Software components (training and evaluation scripts)
- Models (dummy trained classifier model)
- Evaluation results (dummy results)

All components are linked to their direct parents during creation to form a
complete provenance graph that can be exported and audited.

For a more comprehensive example that does run the training and evaluation
pipelines, see the
[MNIST training provenance collection example](../mnist/README.md).

## Prerequisites

### System Requirements
- Rust toolchain (1.85 or above)
- Docker and Docker-compose

### Setting up Atlas CLI

Ensure Atlas CLI is built and available in your PATH:

```bash
# Build Atlas CLI (from the root directory)
cargo build --release
# Add to PATH or use full path
export PATH=$PATH:./target/release
```

### Setting up the Database Backend

Start the database backend (if not already running):

```bash
# Start the database service
cd storage_service && docker-compose build && docker-compose up -d && cd ..
```

## Running the Example

You can launch the demo using the provided bash script, and progress through the
demo by pressing any key to proceed at each step:

``` bash
./collect_mnist_provenance.sh
```

The demo script also displays the generated and linked manifests after select
operations.

### Demo Steps

1. Generate provenance signing key pair (deleted at the end of the demo).
2. Download the MNIST Dataset (training and test data) from HuggingFace.
3. Generate and link the C2PA manifests for the training script, training data,
   and dummy model. Each manifest includes a (mock) hardware-based attestation.
4. Generate and link the C2PA manifests for the evaluation script, dummy model,
   test data, and evaluation results. Each manifest includes a (mock)
   hardware-based attestation.
5. Export the collected provenance graph.
6. Verify the provenance graph: For each manifest, the manifest format, hashes
   for every tracked artifact, and expected manifest links are validated.
